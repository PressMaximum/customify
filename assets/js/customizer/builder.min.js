!function(r,l){var d=r(document),u={};l.bind("ready",function(e,t){function c(o,e,i,n){var s,a;"yes"!==Customify_Layout_Builder.hide_switcher&&"object"==typeof o.versions&&(s="",r.each(o.versions,function(e,t){s+='<option value="'+e+'" '+(e===n?' selected="selected" ':"")+">"+t.label+"</option>"}),s&&(a=r('<span class="customify-swicth-version button-primary"><span>'+Customify_Layout_Builder.swicth_version+'</span><select class="builder-version-change ">'+s+"</select></span>"),r(".customify--cb-actions",e.container).prepend(a)),a.on("change","select",function(){var e,t=r(this).val();u[i+n]&&u[i+n].container.hide(),void 0===u[i+t]&&(e=new("v2"===t?CustomizeBuilder_V2:CustomizeBuilder_V1)(o,i),c(o,e,i,t),u[i+t]=e),l.control(o.version_id).setting.set(t),d.trigger("customify/customizer/value_changed"),u[i+t]&&u[i+t].container.show(),a.find("option").removeAttr("selected"),a.find('option[value="'+n+'"]').attr("selected","selected")}))}_.each(Customify_Layout_Builder.builders,function(e,t){var o,i="v1";void 0!==e.version_id?i=l.control(e.version_id).params.value:e.version_id=!1,o=new("v2"===i?CustomizeBuilder_V2:CustomizeBuilder_V1)(e,t),c(e,u[t+i]=o,t,i)}),l.bind("pane-contents-reflowed",function(){setTimeout(function(){r("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice .footer_moved_widgets_text").length||r("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice").append('<p class="footer_moved_widgets_text">'+Customify_Layout_Builder.footer_moved_widgets_text+"</p>")},1e3)}),l.state("expandedSection").bind(function(e){r(".customify--device-panel .grid-stack-item").removeClass("item-active"),r(".customify--cb-row").removeClass("row-active"),e&&(r('.customify--cb-row[data-id="'+e.id+'"]').addClass("row-active"),r(".customify--device-panel .grid-stack-item.for-s-"+e.id).addClass("item-active"))})}),d.on("click",".focus-section",function(e){e.preventDefault();e=r(this).attr("data-id")||"";(e=e||(e=r(this).attr("href")||"").replace("#",""))&&l.section(e)&&l.section(e).focus()}),d.on("click",".focus-control",function(e){e.preventDefault();e=r(this).attr("data-id")||"";(e=e||(e=r(this).attr("href")||"").replace("#",""))&&l.control(e)&&l.control(e).focus()}),d.on("click",".focus-panel",function(e){e.preventDefault();e=r(this).attr("data-id")||"";(e=e||(e=r(this).attr("href")||"").replace("#",""))&&l.panel(e)&&l.panel(e).focus()}),d.on("click",".save-template-form .save-builder-template",function(e){e.preventDefault();var t=r(this).closest(".customize-control"),o=r(".template-input-name",t),e=o.val();e&&""!==e&&r.post(ajaxurl,{action:"customify_builder_save_template",name:o.val(),id:o.attr("data-builder-id")||"",control:o.attr("data-control-id")||"",preview_data:l.get(),nonce:Customify_Layout_Builder.nonce},function(e){e.success&&(o.val(""),t.find(".list-saved-templates").prepend(e.data.li),t.find(".list-saved-templates").addClass("has-templates"))})}),d.on("click",".list-saved-templates .saved_template .remove-tpl",function(e){e.preventDefault();var t=r(this).parent(),o=r(this).closest(".customize-control"),e=r(".template-input-name",o),i=t.data("id")||"";r.post(ajaxurl,{action:"customify_builder_save_template",id:e.attr("data-builder-id")||"",remove:i,nonce:Customify_Layout_Builder.nonce},function(e){t.remove(),o.find(".list-saved-templates li.saved_template").length<=0&&o.find(".list-saved-templates").removeClass("has-templates")})});d.on("click",".list-saved-templates .saved_template .load-tpl",function(e){e.preventDefault();var e=r(this).parent(),t=r.Deferred(),o=_.clone(window.location),i=e.data("control-id")||"",e=e.data("data")||{},n=(_.isObject(e)||(e={}),_.each(e,function(e,t){l.control(t)&&!_.isEmpty(e)&&l.control(t).setting.set(encodeURI(JSON.stringify(e)))}),r(".wp-full-overlay")),s=(n.addClass("customize-active full-overlay-active customize-loading"),function(){var e;if(!(0<l.state("processing").get()))return l.state("processing").unbind(s),(e=l.requestChangesetUpdate()).done(function(){r(window).off("beforeunload.customize-confirm"),top.location.href=o.origin+o.pathname+"?autofocus[control]="+i+"&url="+encodeURIComponent(l.previewer.previewUrl.get())+"&changeset_uuid="+l.settings.changeset.uuid,t.resolve()}),e.fail(function(){n.removeClass("customize-loading"),t.reject()}),t.promise()});0===l.state("processing").get()?s():l.state("processing").bind(s)}),d.on("mouseover",".customify--cb-row .grid-stack-item:not(.no-tooltip)",function(e){var t=r(this),o=r(".customify--cb-item-remove",t).outerWidth()+r(".customify--cb-item-setting",t).outerWidth();r(".grid-stack-item-content",t).innerWidth()-50<o&&t.addClass("show-tooltip")}),d.on("mouseleave",".customify--cb-row .grid-stack-item:not(.no-tooltip)",function(e){r(this).removeClass("show-tooltip")})}(jQuery,wp.customize||null);